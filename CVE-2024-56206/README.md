# CVE-2024-56206
## Privilege Escalation
### Vulnerable Code

the vulnerable code located at `gap-hub-user-role/user-profileoption.php`

```php
function user_information()
 {
  global $current_user;
  $current_user = wp_get_current_user();
  <-- CUT -->			
				if ( !empty($_POST['pass1'] ) && !empty( $_POST['pass2'] ) )
				 {
					if ( $_POST['pass1'] == $_POST['pass2'] )
						wp_update_user( array( 'ID' => $current_user->id, 'user_pass' => esc_attr( $_POST['pass1'] ) ) );
					else
						 $error = __('The passwords you entered do not match.  Your password was not updated.');
						 echo "<span style='font-size:16px; color:red;'>$error</span>";
				}
				
				
	 	}				
 
 ?>
```

As we can see, the vulnerable code lacks validation such as a nonce or old password check. This allows us to craft a malicious HTML that can reset the password by tricking the user into accessing the malicious HTML.